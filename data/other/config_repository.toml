
version = "1.0"
i18n = "repository_config"
[main]
name.en = ""
    [main.main]
    name.en = ""
        # if method == "tar": question["value"] = False
        [main.main.description]
        type = "string"
        default = ""

        [main.main.is_remote]
        type = "boolean"
        yes = true
        no = false
        visible = "creation && is_remote"
        default = "no"

        [main.main.location]
        ask.en = "{is_remote}"
        type = "string"
        visible = "creation && is_remote"
        pattern.regexp = '^([^\W_A-Z]+([-]*[^\W_A-Z]+)*\.)+((xn--)?[^\W_]{2,})$'
        pattern.error = '' # TODO "Please provide a valid domain"
        default = ""
        # FIXME: can't be a domain of this instances ?

        [main.main.is_f2f]
        ask.en = "{is_remote}"
        help = ""
        type = "boolean"
        yes = true
        no = false
        visible = "creation && is_remote"
        default = "no"

        [main.main.public_key]
        type = "alert"
        style = "info"
        visible = "creation && is_remote && ! is_f2f"

        [main.main.alert]
        help = ''
        type = "tags"
        visible = "is_remote && is_f2f"
        pattern.regexp = '^[\w\+.-]+@([^\W_A-Z]+([-]*[^\W_A-Z]+)*\.)+((xn--)?[^\W_]{2,})$'
        pattern.error = "It seems it's not a valid email"
        default = []
        # "value": alert,

        [main.main.alert_delay]
        help = ''
        type = "number"
        visible = "is_remote && is_f2f"
        min = 1
        default = 7

        [main.main.quota]
        type = "string"
        visible = "is_remote && is_f2f"
        pattern.regexp = '^\d+[MGT]$'
        pattern.error = '' # TODO ""
        default = ""

        [main.main.port]
        type = "number"
        visible = "is_remote && !is_f2f"
        min = 1
        max = 65535
        default = 22

        [main.main.user]
        type = "string"
        visible = "is_remote && !is_f2f"
        default = ""

        [main.main.method]
        type = "select"
        # "value": method,
        choices.borg = "BorgBackup (recommended)"
        choices.tar = "Legacy tar archive mechanism"
        default = "borg"
        visible = "!is_remote"
        
        [main.main.path]
        type = "path"
        visible = "!is_remote or (is_remote and !is_f2f)"
        default = "/home/yunohost.backup/archives"

